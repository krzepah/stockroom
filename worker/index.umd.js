!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("unistore")):"function"==typeof define&&define.amd?define(["unistore"],t):e.stockroom=t(e.unistore)}(this,function(e){function t(e,t){if(Array.isArray(e)){e=e.slice(0,t.length);for(var o=0;o<t.length;o++)void 0!==t[o]&&(e[o]=n(t[o],e[o]))}else for(var i in e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e),t)t.hasOwnProperty(i)&&(void 0===t[i]?delete e[i]:e[i]=n(t[i],e[i]));return e}function n(e,n){return null!=n&&null!=e&&"object"==typeof n&&"object"==typeof e?t(n,e):e}return e=e&&e.hasOwnProperty("default")?e.default:e,function(n){var o=e(n),i=o.actions={},r={},a=0,f=[],u=[];for(var s in n)r[s]=n[s];function p(e){1===u.push(e)&&setTimeout(c)}function c(){"function"==typeof postMessage&&1===postMessage.length&&postMessage(u),u.length=0}function l(e){if(a>0)return f.push(e);var n=e.type,r=e.id,u=e.overwrite,s=e.update,c=e.action;if("@@STATE"===n)!0===e.partial&&(s=t(o.getState(),s),u=!0),o.setState(s,!0===u,c);else if("@@ACTION"===n){var l=i[c.type];c.params?l.apply(i,c.params):l.call(i,c.payload),r&&p({type:"@@ACTIONCOMPLETE",id:r})}}return"function"==typeof addEventListener&&addEventListener("message",function(e){var t=e.data;if("object"!=typeof t);else if("pop"in t)if(1===t.length)l(t[0]);else for(var n=0;n<t.length;n++)l(t[n]);else l(t)}),o.subscribe(function(e,t,n,o){r=e,p({type:"@@STATE",update:n,action:t&&t.name,partial:!0,params:o})}),o.registerActions=function(e){for(var t in"function"==typeof e&&(e=e(o)),e)i[t]=o.action(e[t])},o.freeze=function(){a++},o.unfreeze=function(){if(!--a){var e=f;f=[];for(var t=0;t<e.length;t++)l(e[t])}},p({type:"@@STATE",initial:!0,update:o.getState()}),o}});
//# sourceMappingURL=index.umd.js.map
