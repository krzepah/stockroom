var e,t=(e=require("unistore"))&&"object"==typeof e&&"default"in e?e.default:e;function n(e,t){if(Array.isArray(e)){e=e.slice(0,t.length);for(var n=0;n<t.length;n++)void 0!==t[n]&&(e[n]=r(t[n],e[n]))}else for(var i in e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e),t)t.hasOwnProperty(i)&&(void 0===t[i]?delete e[i]:e[i]=r(t[i],e[i]));return e}function r(e,t){return null!=t&&null!=e&&"object"==typeof t&&"object"==typeof e?n(t,e):e}module.exports=function(e){var r=t(e),i=r.actions={},a={},o=0,f=[],s=[];for(var u in e)a[u]=e[u];function p(e){1===s.push(e)&&setTimeout(l)}function l(){"function"==typeof postMessage&&1===postMessage.length&&postMessage(s),s.length=0}function c(e){if(o>0)return f.push(e);var t=e.type,a=e.id,s=e.overwrite,u=e.update,l=e.action;if("@@STATE"===t)!0===e.partial&&(u=n(r.getState(),u),s=!0),r.setState(u,!0===s,l);else if("@@ACTION"===t){var c=i[l.type];l.params?c.apply(i,l.params):c.call(i,l.payload),a&&p({type:"@@ACTIONCOMPLETE",id:a})}}return"function"==typeof addEventListener&&addEventListener("message",function(e){var t=e.data;if("object"!=typeof t);else if("pop"in t)if(1===t.length)c(t[0]);else for(var n=0;n<t.length;n++)c(t[n]);else c(t)}),r.subscribe(function(e,t,n,r){a=e,p({type:"@@STATE",update:n,action:t&&t.name,partial:!0,params:r})}),r.registerActions=function(e){for(var t in"function"==typeof e&&(e=e(r)),e)i[t]=r.action(e[t])},r.freeze=function(){o++},r.unfreeze=function(){if(!--o){var e=f;f=[];for(var t=0;t<e.length;t++)c(e[t])}},p({type:"@@STATE",initial:!0,update:r.getState()}),r};
//# sourceMappingURL=index.js.map
